import{u as C,a as u,b as w,d as k,_ as b,f as _,o as a,g as d,h as A,w as y,i as o,y as m,K as c,F as l,k as n,t as r,bY as p,v as V,p as S,l as D,j as U}from"./app-88c76d5f.js";const q={props:{show:{type:Boolean,required:!0,default:!1},oldAddress:{type:Object,default:()=>{}}},data:()=>({adding:!1,countriesLoaded:!1,countries:[],filteredStates:[],filteredCities:[],v$:C(),form:{id:null,full_name:"",email_address:"",address:"",postal_code:"",country:"",state:"",city:"",phone:""}}),validations:{form:{full_name:{required:u},email_address:{required:u},address:{required:u},postal_code:{required:u},country:{required:u},state:{required:u},city:{required:u},phone:{required:u}}},watch:{oldAddress(t,s){t&&!this.is_empty_obj(t)?this.processOldAddress(t):this.resetData()}},computed:{statePlaceholer(){return this.$i18n.t("select_a_state")},cityPlaceholer(){return this.$i18n.t("select_a_city")},isVisible:{get:function(){return this.show},set:function(t){}}},created(){this.fetchCountries()},methods:{...w("address",["addAddress"]),...k("address",["setAddresses"]),async fetchCountries(){if(!this.countriesLoaded){const t=await this.call_api("get","all-countries");t.data.success&&(this.countriesLoaded=!0,this.countries=t.data.data)}},async countryChanged(t){const s=await this.call_api("get",`states/${this.form.country}`);s.data.success?(this.filteredStates=s.data.data,this.form.state="",this.form.city="",this.filteredCities=[]):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})},async stateChanged(t){const s=await this.call_api("get",`cities/${this.form.state}`);s.data.success?(this.filteredCities=s.data.data,this.form.city=""):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})},async addNewAddress(){if(!await this.v$.$validate())return;this.adding=!0;const s=await this.call_api("post","address/create",this.form);s.data.success?(this.addAddress(s.data.data),this.snack({message:s.data.message}),this.resetData(),this.closeDialog()):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"}),this.adding=!1},async updateAddress(){if(!await this.v$.$validate())return;this.adding=!0;const s=await this.call_api("post","address/update",this.form);s.data.success?(this.setAddresses(s.data.data),this.snack({message:s.data.message}),this.closeDialog()):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"}),this.adding=!1},resetData(){this.form.id=null,this.full_name="",this.email_address="",this.form.address="",this.form.postal_code="",this.form.country="",this.form.state="",this.form.city="",this.form.phone="",this.v$.form.$reset()},async processOldAddress(t){let s={...t};this.form.id=s.id,this.full_name=s.full_name,this.email_address=s.email_address,this.form.address=s.address,this.form.postal_code=s.postal_code,this.form.phone=s.phone;let h=this.countries.find(i=>i.name===s.country);this.form.country=h.id,await this.countryChanged(h.id);let f=this.filteredStates.find(i=>i.name===s.state);this.form.state=f.id,await this.stateChanged(f.id);let g=this.filteredCities.find(i=>i.name===s.city);this.form.city=g.id},closeDialog(){this.isVisible=!1,this.$emit("close")}}},F={class:"white pa-5 rounded"},N={class:"row"},B={class:"col-md-4"},j={class:"form-group"},L=["placeholder"],M={class:"col-md-4"},P={class:"form-group"},O=["placeholder"],T={class:"col-md-4"},z={class:"form-group"},E=["placeholder"],K={class:"col-md-4"},Y={class:"form-group"},G=["label","placeholder"],H={class:"col-md-4"},I={class:"form-group"},J=["placeholder"],Q=["value"],R={class:"col-md-4"},W={class:"form-group"},X=["placeholder"],Z=["value"],x={class:"col-md-4"},ee={class:"form-group"},se=["placeholder"],te=["value"],oe={class:"col-md-4"},ae={class:"form-group"},de=["placeholder"],ie={class:"text-right mt-4"};function re(t,s,h,f,g,i){const v=_("v-btn"),$=_("v-form");return a(),d("div",F,[A($,{onSubmit:s[11]||(s[11]=U(e=>i.addNewAddress(),["prevent"])),autocomplete:"chrome-off"},{default:y(()=>[o("div",N,[o("div",B,[o("div",j,[m(o("input",{placeholder:t.$t("email_address"),type:"email","onUpdate:modelValue":s[0]||(s[0]=e=>t.form.email_address=e),"hide-details":"auto",required:"",class:"form-control"},null,8,L),[[c,t.form.email_address]]),(a(!0),d(l,null,n(t.v$.form.email_address.$errors,e=>(a(),d("p",{key:e.$uid,class:"text-red"},r(e.$message),1))),128))])]),o("div",M,[o("div",P,[m(o("input",{placeholder:t.$t("full_name"),type:"text","onUpdate:modelValue":s[1]||(s[1]=e=>t.form.full_name=e),"hide-details":"auto",required:"",class:"form-control"},null,8,O),[[c,t.form.full_name]]),(a(!0),d(l,null,n(t.v$.form.full_name.$errors,e=>(a(),d("p",{key:e.$uid,class:"text-red"},r(e.$message),1))),128))])]),o("div",T,[o("div",z,[m(o("input",{placeholder:t.$t("phone_number"),type:"number","onUpdate:modelValue":s[2]||(s[2]=e=>t.form.phone=e),"hide-details":"auto",required:"",class:"form-control"},null,8,E),[[c,t.form.phone]]),(a(!0),d(l,null,n(t.v$.form.phone.$errors,e=>(a(),d("p",{key:e.$uid,class:"text-red"},r(e.$message),1))),128))])]),o("div",K,[o("div",Y,[m(o("textarea",{label:t.$t("address"),placeholder:t.$t("Street Address"),"onUpdate:modelValue":s[3]||(s[3]=e=>t.form.address=e),"hide-details":"auto",rows:"1",required:"","no-resize":"",class:"form-control"},null,8,G),[[c,t.form.address]]),(a(!0),d(l,null,n(t.v$.form.address.$errors,e=>(a(),d("p",{key:e.$uid,class:"text-red"},r(e.$message),1))),128))])]),o("div",H,[o("div",I,[m(o("select",{"onUpdate:modelValue":s[4]||(s[4]=e=>t.form.country=e),class:"form-control",placeholder:t.$t("select_country"),onChange:s[5]||(s[5]=(...e)=>i.countryChanged&&i.countryChanged(...e))},[s[12]||(s[12]=o("option",{value:"",disabled:""},"Select a Country",-1)),(a(!0),d(l,null,n(t.countries,e=>(a(),d("option",{key:e.id,value:e.id},r(e.name),9,Q))),128))],40,J),[[p,t.form.country]]),(a(!0),d(l,null,n(t.v$.form.country.$errors,e=>(a(),d("p",{key:e.$uid,class:"text-red"},r(e.$message),1))),128))])]),o("div",R,[o("div",W,[m(o("select",{"onUpdate:modelValue":s[6]||(s[6]=e=>t.form.state=e),class:"form-control",placeholder:i.statePlaceholer,onChange:s[7]||(s[7]=(...e)=>i.stateChanged&&i.stateChanged(...e))},[s[13]||(s[13]=o("option",{value:"",disabled:""},"Select a State",-1)),(a(!0),d(l,null,n(t.filteredStates,e=>(a(),d("option",{key:e.id,value:e.id},r(e.name),9,Z))),128))],40,X),[[p,t.form.state]]),(a(!0),d(l,null,n(t.v$.form.state.$errors,e=>(a(),d("p",{key:e.$uid,class:"text-red"},r(e.$message),1))),128))])]),o("div",x,[o("div",ee,[m(o("select",{"onUpdate:modelValue":s[8]||(s[8]=e=>t.form.city=e),class:"form-control",placeholder:i.cityPlaceholer,onChange:s[9]||(s[9]=(...e)=>t.handleCityChange&&t.handleCityChange(...e))},[s[14]||(s[14]=o("option",{value:"",disabled:""},"Select a City",-1)),(a(!0),d(l,null,n(t.filteredCities,e=>(a(),d("option",{key:e.id,value:e.id},r(e.name),9,te))),128))],40,se),[[p,t.form.city]]),(a(!0),d(l,null,n(t.v$.form.city.$errors,e=>(a(),d("p",{key:e.$uid,class:"text-red"},r(e.$message),1))),128))])]),o("div",oe,[o("div",ae,[m(o("input",{placeholder:t.$t("postal_code"),type:"text","onUpdate:modelValue":s[10]||(s[10]=e=>t.form.postal_code=e),"hide-details":"auto",required:"",class:"form-control"},null,8,de),[[c,t.form.postal_code]]),(a(!0),d(l,null,n(t.v$.form.postal_code.$errors,e=>(a(),d("p",{key:e.$uid,class:"text-red"},r(e.$message),1))),128))])])]),o("div",ie,[t.is_empty_obj(h.oldAddress)?D("",!0):(a(),V(v,{key:0,elevation:"0",type:"submit",color:"primary",onClick:i.updateAddress,loading:t.adding,disabled:t.adding},{default:y(()=>[S(r(t.$t("update")),1)]),_:1},8,["onClick","loading","disabled"]))])]),_:1})])}const ne=b(q,[["render",re]]);export{ne as A};
