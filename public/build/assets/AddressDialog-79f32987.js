import{u as k,a as n,b as A,d as U,_ as D,f,o as a,v as $,w as c,i,h as r,t as l,g as o,k as m,F as u,p as _,j as q}from"./app-600fcb8d.js";const S={props:{show:{type:Boolean,required:!0,default:!1},oldAddress:{type:Object,default:()=>{}}},data:()=>({adding:!1,countriesLoaded:!1,countries:[],filteredStates:[],filteredCities:[],v$:k(),form:{id:null,full_name:"",email_address:"",address:"",postal_code:"",country:"",state:"",city:"",phone:""}}),validations:{form:{full_name:{required:n},email_address:{required:n},address:{required:n},postal_code:{required:n},country:{required:n},state:{required:n},city:{required:n},phone:{required:n}}},watch:{oldAddress(e,s){e&&!this.is_empty_obj(e)?this.processOldAddress(e):this.resetData()}},computed:{statePlaceholer(){return this.$i18n.t("select_a_state")},cityPlaceholer(){return this.$i18n.t("select_a_city")},isVisible:{get:function(){return this.show},set:function(e){}}},created(){this.fetchCountries()},methods:{...A("address",["addAddress"]),...U("address",["setAddresses"]),async fetchCountries(){if(!this.countriesLoaded){const e=await this.call_api("get","all-countries");e.data.success&&(this.countriesLoaded=!0,this.countries=e.data.data)}},async countryChanged(e){const s=await this.call_api("get",`states/${this.form.country}`);s.data.success?(this.filteredStates=s.data.data,this.form.state="",this.form.city="",this.filteredCities=[]):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})},async stateChanged(e){const s=await this.call_api("get",`cities/${this.form.state}`);s.data.success?(this.filteredCities=s.data.data,this.form.city=""):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"})},async addNewAddress(){if(!await this.v$.$validate())return;this.adding=!0;const s=await this.call_api("post","address/create",this.form);s.data.success?(this.addAddress(s.data.data),this.snack({message:s.data.message}),this.resetData(),this.closeDialog()):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"}),this.adding=!1},async updateAddress(){if(!await this.v$.$validate())return;this.adding=!0;const s=await this.call_api("post","address/update",this.form);s.data.success?(this.setAddresses(s.data.data),this.snack({message:s.data.message}),this.closeDialog()):this.snack({message:this.$i18n.t("something_went_wrong"),color:"red"}),this.adding=!1},resetData(){this.form.id=null,this.full_name="",this.email_address="",this.form.address="",this.form.postal_code="",this.form.country="",this.form.state="",this.form.city="",this.form.phone="",this.v$.form.$reset()},async processOldAddress(e){let s={...e};this.form.id=s.id,this.full_name=s.full_name,this.email_address=s.email_address,this.form.address=s.address,this.form.postal_code=s.postal_code,this.form.phone=s.phone;let h=this.countries.find(d=>d.name===s.country);this.form.country=h.id,await this.countryChanged(h.id);let v=this.filteredStates.find(d=>d.name===s.state);this.form.state=v.id,await this.stateChanged(v.id);let b=this.filteredCities.find(d=>d.name===s.city);this.form.city=b.id},closeDialog(){this.isVisible=!1,this.$emit("close")}}},F={class:"white pa-5 rounded"},N={class:"mb-3"},B={class:"mb-1 fs-13 fw-500"},j={class:"mb-3"},L={class:"mb-1 fs-13 fw-500"},P={class:"mb-3"},O={class:"mb-1 fs-13 fw-500"},M={class:"mb-3"},z={class:"mb-1 fs-13 fw-500"},E={class:"mb-3"},T={class:"mb-1 fs-13 fw-500"},G={class:"mb-3"},H={class:"mb-1 fs-13 fw-500"},I={class:"mb-3"},J={class:"mb-3"},K={class:"mb-1 fs-13 fw-500"},Q={class:"text-right mt-4"};function R(e,s,h,v,b,d){const p=f("v-text-field"),w=f("v-textarea"),y=f("v-autocomplete"),g=f("v-btn"),V=f("v-form"),C=f("v-dialog");return a(),$(C,{modelValue:d.isVisible,"onUpdate:modelValue":s[9]||(s[9]=t=>d.isVisible=t),"max-width":"600px","onClick:outside":d.closeDialog},{default:c(()=>[i("div",F,[r(V,{onSubmit:s[8]||(s[8]=q(t=>d.addNewAddress(),["prevent"])),autocomplete:"chrome-off"},{default:c(()=>[i("div",N,[i("div",B,l(e.$t("full_name")),1),r(p,{placeholder:e.$t("full_name"),type:"text",modelValue:e.form.full_name,"onUpdate:modelValue":s[0]||(s[0]=t=>e.form.full_name=t),"hide-details":"auto",required:"",variant:"outlined"},null,8,["placeholder","modelValue"]),(a(!0),o(u,null,m(e.v$.form.full_name.$errors,t=>(a(),o("p",{key:t.$uid,class:"text-red"},l(t.$message),1))),128))]),i("div",j,[i("div",L,l(e.$t("email_address")),1),r(p,{placeholder:e.$t("email_address"),type:"email",modelValue:e.form.email_address,"onUpdate:modelValue":s[1]||(s[1]=t=>e.form.email_address=t),"hide-details":"auto",required:"",variant:"outlined"},null,8,["placeholder","modelValue"]),(a(!0),o(u,null,m(e.v$.form.email_address.$errors,t=>(a(),o("p",{key:t.$uid,class:"text-red"},l(t.$message),1))),128))]),i("div",P,[i("div",O,l(e.$t("address")),1),r(w,{label:e.$t("address"),modelValue:e.form.address,"onUpdate:modelValue":s[2]||(s[2]=t=>e.form.address=t),"hide-details":"auto",rows:"3",required:"",variant:"outlined","no-resize":""},null,8,["label","modelValue"]),(a(!0),o(u,null,m(e.v$.form.address.$errors,t=>(a(),o("p",{key:t.$uid,class:"text-red"},l(t.$message),1))),128))]),i("div",M,[i("div",z,l(e.$t("postal_code")),1),r(p,{placeholder:e.$t("postal_code"),type:"text",modelValue:e.form.postal_code,"onUpdate:modelValue":s[3]||(s[3]=t=>e.form.postal_code=t),"hide-details":"auto",required:"",variant:"outlined"},null,8,["placeholder","modelValue"]),(a(!0),o(u,null,m(e.v$.form.postal_code.$errors,t=>(a(),o("p",{key:t.$uid,class:"text-red"},l(t.$message),1))),128))]),i("div",E,[i("div",T,l(e.$t("country")),1),r(y,{modelValue:e.form.country,"onUpdate:modelValue":[s[4]||(s[4]=t=>e.form.country=t),d.countryChanged],items:e.countries,label:e.$t("select_country"),"hide-details":"auto",variant:"outlined","item-title":"name","item-value":"id",dense:"",autocomplete:"off","custom-filter":d.countryChanged},null,8,["modelValue","items","label","custom-filter","onUpdate:modelValue"]),(a(!0),o(u,null,m(e.v$.form.country.$errors,t=>(a(),o("p",{key:t.$uid,class:"text-red"},l(t.$message),1))),128))]),i("div",G,[i("div",H,l(e.$t("state")),1),r(y,{modelValue:e.form.state,"onUpdate:modelValue":[s[5]||(s[5]=t=>e.form.state=t),d.stateChanged],items:e.filteredStates,"hide-details":"auto",label:d.statePlaceholer,variant:"outlined","item-title":"name","item-value":"id",dense:""},null,8,["modelValue","items","label","onUpdate:modelValue"]),(a(!0),o(u,null,m(e.v$.form.state.$errors,t=>(a(),o("p",{key:t.$uid,class:"text-red"},l(t.$message),1))),128))]),i("div",I,[s[10]||(s[10]=i("div",{class:"mb-1 fs-13 fw-500"},"City",-1)),r(y,{modelValue:e.form.city,"onUpdate:modelValue":s[6]||(s[6]=t=>e.form.city=t),items:e.filteredCities,label:d.cityPlaceholer,"hide-details":"auto",variant:"outlined","item-title":"name","item-value":"id",dense:""},null,8,["modelValue","items","label"]),(a(!0),o(u,null,m(e.v$.form.city.$errors,t=>(a(),o("p",{key:t.$uid,class:"text-red"},l(t.$message),1))),128))]),i("div",J,[i("div",K,l(e.$t("phone_number")),1),r(p,{placeholder:e.$t("phone_number"),type:"number",modelValue:e.form.phone,"onUpdate:modelValue":s[7]||(s[7]=t=>e.form.phone=t),"hide-details":"auto",required:"",variant:"outlined"},null,8,["placeholder","modelValue"]),(a(!0),o(u,null,m(e.v$.form.phone.$errors,t=>(a(),o("p",{key:t.$uid,class:"text-red"},l(t.$message),1))),128))]),i("div",Q,[r(g,{text:"",onClick:d.closeDialog,elevation:"0",class:"mr-2"},{default:c(()=>[_(l(e.$t("cancel")),1)]),_:1},8,["onClick"]),e.is_empty_obj(h.oldAddress)?(a(),$(g,{key:1,elevation:"0",type:"submit",color:"primary",onClick:d.addNewAddress,loading:e.adding,disabled:e.adding},{default:c(()=>[_(l(e.$t("add_new")),1)]),_:1},8,["onClick","loading","disabled"])):(a(),$(g,{key:0,elevation:"0",type:"submit",color:"primary",onClick:d.updateAddress,loading:e.adding,disabled:e.adding},{default:c(()=>[_(l(e.$t("update")),1)]),_:1},8,["onClick","loading","disabled"]))])]),_:1})])]),_:1},8,["modelValue","onClick:outside"])}const X=D(S,[["render",R]]);export{X as A};
